import{S as C,F as v,P as z,W as B,l as L,M as P,m as x,a as W,B as F,n as H,o as k,p as E}from"./three.module-pkULuz9p.js";const s=new C;s.fog=new v(0,1,1e3);const p=new z(75,window.innerWidth/window.innerHeight,.1,1e3);p.position.z=30;const y=new B;y.setSize(window.innerWidth,window.innerHeight);document.body.appendChild(y.domElement);let c,a,d,r,u=!1;const i=[],l=64,M=.5,G=.6,I=new L(M,1,M);for(let e=0;e<l;e++){const o=new P({color:new x().setHSL(e/l,1,.5),emissive:new x().setHSL(e/l,1,.5),emissiveIntensity:.5}),t=new W(I,o);t.position.x=(e-l/2)*G,i.push(t),s.add(t)}const f=1e3,S=new F,w=new Float32Array(f*3),m=new Float32Array(f*3);for(let e=0;e<f*3;e+=3)w[e]=(Math.random()-.5)*50,w[e+1]=(Math.random()-.5)*50,w[e+2]=(Math.random()-.5)*50,m[e]=(Math.random()-.5)*.1,m[e+1]=Math.random()*.2,m[e+2]=(Math.random()-.5)*.1;S.setAttribute("position",new H(w,3));const q=new k({color:16777215,size:.5,opacity:.6,transparent:!0}),g=new E(S,q);s.add(g);const n=document.createElement("button");n.innerText="Start Audio";n.style.position="absolute";n.style.top="20px";n.style.left="20px";n.style.padding="10px 20px";n.style.fontSize="16px";n.style.backgroundColor="#00ff00";n.style.border="none";n.style.borderRadius="5px";n.style.cursor="pointer";n.style.zIndex="1000";document.body.appendChild(n);n.addEventListener("click",async()=>{if(u)d&&(d.disconnect(),c.close()),u=!1,n.innerText="Start Audio",n.style.backgroundColor="#00ff00";else try{c=new(window.AudioContext||window.webkitAudioContext),a=c.createAnalyser(),a.fftSize=256;const e=a.frequencyBinCount;r=new Uint8Array(e);const o=await navigator.mediaDevices.getUserMedia({audio:!0});d=c.createMediaStreamSource(o),d.connect(a),u=!0,n.innerText="Stop Audio",n.style.backgroundColor="#ff0000"}catch(e){console.error("Error accessing microphone:",e),alert("Please allow microphone access to use this visualization")}});function A(){if(requestAnimationFrame(A),u&&a){a.getByteFrequencyData(r);for(let t=0;t<i.length;t++){const h=Math.floor(t*r.length/i.length),b=r[h]/128;i[t].scale.y=Math.max(.1,b*20),i[t].position.y=i[t].scale.y/2-10,i[t].material.emissiveIntensity=b}const e=r.reduce((t,h)=>t+h)/r.length,o=g.geometry.attributes.position.array;for(let t=0;t<f*3;t+=3)o[t+1]+=m[t+1]*(e/128),o[t+1]>25&&(o[t+1]=-25);g.geometry.attributes.position.needsUpdate=!0}s.rotation.y+=.002,y.render(s,p)}window.addEventListener("resize",()=>{p.aspect=window.innerWidth/window.innerHeight,p.updateProjectionMatrix(),y.setSize(window.innerWidth,window.innerHeight)});A();
